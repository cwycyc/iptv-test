name: '自动同步上游仓库'

on:
  # 允许在GitHub网页上手动触发工作流
  workflow_dispatch:
  # 每天UTC时间0点（北京时间早上8点）自动运行一次
  schedule:
    - cron: '0 0 * * *'

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: 配置Git
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'

      # 关键步骤：使用同步Action
      - name: 同步上游仓库
        uses: tgymnich/fork-sync@v1.5
        with:
          # 请确保将此处的 [UPSTREAM_OWNER] 替换为原作者的ID：0987363
          upstream_repository: 0987363/iptv-chengdu
          # 同步到你的main分支（如果你Fork后改了默认分支，请相应调整）
          target_branch: main
          # 使用GitHub自动生成的令牌，拥有你Fork仓库的写入权限
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # 冲突解决策略：使用上游仓库的改动（覆盖你Fork中的冲突文件）
          # 注意：这意味着你Fork中独有的、与上游冲突的修改可能会被覆盖，请知悉。
          conflict_resolution: hardreset
          # 由于使用了hardreset，需要强制推送到你的Fork
          force_push: true
